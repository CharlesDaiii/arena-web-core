parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"KW6x":[function(require,module,exports) {
AFRAME.registerComponent("arena-camera",{schema:{enabled:{type:"boolean",default:!1},displayName:{type:"string",default:"No Name"},color:{type:"string",default:"#"+Math.floor(16777215*Math.random()).toString(16)},rotation:{type:"vec4",default:new THREE.Quaternion},position:{type:"vec3",default:new THREE.Vector3},vioRotation:{type:"vec4",default:new THREE.Quaternion},vioPosition:{type:"vec3",default:new THREE.Vector3}},init:function(){this.vioMatrix=new THREE.Matrix4,this.camParent=new THREE.Matrix4,this.cam=new THREE.Matrix4,this.cpi=new THREE.Matrix4,this.lastPose="",this.heartBeatCounter=0,this.tick=AFRAME.utils.throttleTick(this.tick,ARENA.updateMillis,this)},publishPose(){const t=this.data;if(!t.enabled)return;const i={object_id:ARENA.camName,displayName:t.displayName,action:"create",type:"object",data:{object_type:"camera",position:{x:parseFloat(t.position.x.toFixed(3)),y:parseFloat(t.position.y.toFixed(3)),z:parseFloat(t.position.z.toFixed(3))},rotation:{x:parseFloat(t.rotation._x.toFixed(3)),y:parseFloat(t.rotation._y.toFixed(3)),z:parseFloat(t.rotation._z.toFixed(3)),w:parseFloat(t.rotation._w.toFixed(3))},color:t.color}};ARENA.JitsiAPI&&(i.jitsiId=ARENA.JitsiAPI.getJitsiId(),i.hasAudio=ARENA.JitsiAPI.hasAudio(),i.hasVideo=ARENA.JitsiAPI.hasVideo()),ARENA.FaceTracker&&(i.hasAvatar=ARENA.FaceTracker.running()),publish(ARENA.outputTopic+ARENA.camName,i)},publishVio(){const t=this.data;if(t.enabled&&""!==ARENA.fixedCamera){const i={object_id:ARENA.camName,action:"create",type:"object",data:{object_type:"camera",position:{x:parseFloat(t.vioPosition.x.toFixed(3)),y:parseFloat(t.vioPosition.y.toFixed(3)),z:parseFloat(t.vioPosition.z.toFixed(3))},rotation:{x:parseFloat(t.vioRotation._x.toFixed(3)),y:parseFloat(t.vioRotation._y.toFixed(3)),z:parseFloat(t.vioRotation._z.toFixed(3)),w:parseFloat(t.vioRotation._w.toFixed(3))},color:t.color}};publish(ARENA.vioTopic+ARENA.camName,i)}},publishHeadText(){const t=this.data;publish(ARENA.outputTopic+ARENA.scenenameParam+"/head-text_"+ARENA.camName,{object_id:ARENA.camName,action:"create",type:"object",displayName:t.displayName,data:{object_type:"headtext"}})},update(t){this.data.displayName!==t.displayName&&this.publishHeadText()},tick:function(t,i){const o=this.data,a=this.el;this.heartBeatCounter++,o.rotation.setFromRotationMatrix(a.object3D.matrixWorld),o.position.setFromMatrixPosition(a.object3D.matrixWorld),this.camParent=a.object3D.parent.matrixWorld,this.cam=a.object3D.matrixWorld,this.cpi.getInverse(this.camParent),this.cpi.multiply(this.cam),this.vioMatrix.copy(this.cpi),o.vioRotation.setFromRotationMatrix(this.cpi),o.vioPosition.setFromMatrixPosition(this.cpi);const e=rotToText(o.rotation)+" "+coordsToText(o.position);this.lastPose===e&&this.heartBeatCounter%(1e3/ARENA.updateMillis)!=0||(this.publishPose(),this.publishVio(),this.lastPose=e)}});
},{}]},{},["KW6x"], null)
//# sourceMappingURL=/arena-camera.22e79fbf.js.map